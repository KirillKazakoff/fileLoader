(()=>{"use strict";function t(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function n(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function e(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}function r(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||e(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,n,e){return n&&o(t.prototype,n),e&&o(t,e),t}let i=(t=21)=>{let n="",e=crypto.getRandomValues(new Uint8Array(t));for(;t--;){let r=63&e[t];n+=r<36?r.toString(36):r<62?(r-26).toString(36).toUpperCase():r<63?"_":"-"}return n};var c=function(t){return{block:"a",cls:"row-elem row-elem__link",content:"Download",attrs:{href:t.url,download:t.title,rel:"noopener"}}};const l=function(t){return{block:"div",cls:"row",content:[(n=t.title,{block:"span",cls:"row-elem row-elem__title",content:n}),{block:"span",cls:"row-elem row-elem__amount",content:"0.0 Mb"},c(t)],attrs:{id:i(5)}};var n};var u=function(){function n(e){t(this,n),this.node=e,this.title=this.node.querySelector(".row-elem__title"),this.size=this.node.querySelector(".row-elem__amount"),this.url=this.node.querySelector(".row-elem__link"),this.id=this.node.id,this.currentLoad=0,this.totalLoad=0}return a(n,[{key:"changeTotal",value:function(t){var n=t-this.currentLoad;this.currentLoad=t;var e=this.getCurrentAmount(),r=+(n/1024/1024).toFixed(1);this.totalLoad=+(e+r).toFixed(1),this.size.textContent="".concat(this.totalLoad," Mb")}},{key:"getCurrentAmount",value:function(){var t=this.size.textContent.match(/[0-9.]+/).pop();return parseFloat(t)}}]),n}();function s(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,a=[],i=!0,c=!1;try{for(e=e.call(t);!(i=(r=e.next()).done)&&(a.push(r.value),!n||a.length!==n);i=!0);}catch(t){c=!0,o=t}finally{try{i||null==e.return||e.return()}finally{if(c)throw o}}return a}}(t,n)||e(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t){if(!t)return"";if("string"==typeof t)return t;if(Array.isArray(t)){var n="";return t.forEach((function(t){var e=d(t);n+=e})),n}var e=t.block,r=t.cls,o=t.content,a=t.attrs,i="",c="";return a&&Object.entries(a).forEach((function(t){var n=s(t,2),e=n[0],r=n[1];i+="novalidate"===e||"required"===e?"".concat(e," "):"".concat(e,'="').concat(r,'"')})),r&&(c='class="'.concat(r,'"')),function(t,n,e,r){return"input"===t||"img"===t?"<".concat(t," ").concat(r).concat(n,">"):"<".concat(t," ").concat(r).concat(n,">").concat(e,"</").concat(t,">")}(e,c,d(o),i)}var f=function(){function n(e,r){var o=this;t(this,n),this.container=document.querySelector(".rows-container"),this.container.addEventListener("click",(function(t){return o.onClick(t)})),this.onProgress=e,this.onLoad=r}return a(n,[{key:"onClick",value:function(t){if(t.target.className.includes("row-elem__link")){var n=t.target.href,e=t.target.closest(".row"),r=new XMLHttpRequest;r.open("GET",n),r.send(),r.onload=this.onLoad(r),r.onprogress=this.onProgress(e)}}}]),n}(),h=function(){function n(e){t(this,n),this.container=document.querySelector(".form"),this.rowsContainer=this.container.querySelector(".rows-container"),this.renderRows(e);var r=this.getProgressHandler(),o=this.getLoadHandler();this.download=new f(r,o),this.totalDownloaded=document.querySelector(".load-information")}return a(n,[{key:"renderRows",value:function(t){var n=this;t.forEach((function(t){var e=d(l(t));n.rowsContainer.insertAdjacentHTML("beforeend",e)})),this.initRows()}},{key:"initRows",value:function(){this.rows=r(this.rowsContainer.children).map((function(t){return new u(t)}))}},{key:"getRow",value:function(t){return this.rows.find((function(n){return n.id===t}))}},{key:"getProgressHandler",value:function(){var t=this;return function(n){return function(e){var r=t.getRow(n.id);e.lengthComputable&&r.changeTotal(e.loaded),e.total===r.currentLoad&&(r.currentLoad=0,console.log("load ended"))}}}},{key:"getLoadHandler",value:function(){var t=this;return function(n){return function(){if(200===n.status){var e=t.rows.reduce((function(t,n){return t+n.totalLoad}),0);t.totalDownloaded.textContent="You've already downloaded: ".concat(+e.toFixed(1)," Mb")}else console.log("Ошибка ".concat(n.status,": ").concat(n.statusText))}}}}]),n}();const y=[{title:"Example",url:"./files/sample-pdf-download-10-mb.pdf"},{title:"Streams Standart",url:"./files/Streams Standard.pdf"},{title:"XMLHttpRequest Standart",url:"./files/XMLHttpRequest Standard.pdf"}];new function n(){t(this,n),this.form=new h(y)}})();
//# sourceMappingURL=bundle.js.map